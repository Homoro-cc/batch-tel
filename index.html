<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ad Automation Loop</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f0f4f7; }
  header { display:flex; justify-content:space-between; align-items:center; background:#2196F3; color:white; padding:15px 30px; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
  header h1 { margin:0; font-size:20px; }
  .switch { position: relative; display:inline-block; width:50px; height:24px; }
  .switch input { opacity:0; width:0; height:0; }
  .slider { position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#ccc; border-radius:34px; transition:.4s; }
  .slider:before { position:absolute; content:""; height:18px; width:18px; left:3px; bottom:3px; background:white; border-radius:50%; transition:.4s; }
  input:checked + .slider { background-color:#4CAF50; }
  input:checked + .slider:before { transform:translateX(26px); }
  .cards-container { display:flex; justify-content:center; gap:20px; flex-wrap:wrap; padding:40px 20px; }
  .ad-card { background:white; padding:20px 25px; border-radius:15px; box-shadow:0 6px 15px rgba(0,0,0,0.15); width:250px; text-align:center; position:relative; }
  .ad-card .heading { font-size:18px; font-weight:bold; margin-bottom:15px; color:#333; }
  .ad-card button { background:#2196F3; color:white; border:none; padding:12px 25px; font-size:16px; border-radius:8px; cursor:pointer; font-weight:bold; width:100%; box-shadow:0 4px 8px rgba(0,0,0,0.2); transition:background .3s, transform .2s; margin-bottom:15px; }
  .ad-card button:disabled { background:#ccc; cursor:not-allowed; box-shadow:none; }
  .ad-card button:hover:not(:disabled) { background:#64B5F6; transform:translateY(-2px); }
  .ad-card .ad-info { background:#e8f5e9; padding:12px 15px; border-radius:10px; text-align:left; font-size:15px; color:#2E7D32; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
  .ad-card .ad-info p { margin:5px 0; }
  .ad-card .ad-info span { font-weight:bold; }
  .ad-card .card-switch { margin-top:10px; display:flex; align-items:center; justify-content:center; gap:10px; }
  .ad-off-message { color:#f44336; font-weight:bold; font-size:16px; margin-top:15px; }
</style>
</head>
<body>

<header>
  <h1>Ad Automation Loop</h1>
  <label class="switch">
    <input type="checkbox" id="powerSwitch">
    <span class="slider"></span>
  </label>
</header>

<div class="cards-container">
  <div class="ad-card" id="div1">
    <div class="heading">Ad Section 1</div>
    <button class="btn" data-ad="https://otieu.com/4/10176538" data-final="https://example.com/final1">AD is Loading</button>
    <div class="ad-info">
      <p>Ads Loaded: <span class="adsLoaded">0</span></p>
      <p>Button Clicked: <span class="btnClicked">0</span></p>
    </div>
    <div class="card-switch">
      <label class="switch">
        <input type="checkbox" class="cardSwitch">
        <span class="slider"></span>
      </label>
      <span>Automation ON</span>
    </div>
  </div>

  <div class="ad-card" id="div2">
    <div class="heading">Ad Section 2</div>
    <button class="btn" data-ad="https://otieu.com/4/10176500" data-final="https://example.com/final2">AD is Loading</button>
    <div class="ad-info">
      <p>Ads Loaded: <span class="adsLoaded">0</span></p>
      <p>Button Clicked: <span class="btnClicked">0</span></p>
    </div>
    <div class="card-switch">
      <label class="switch">
        <input type="checkbox" class="cardSwitch">
        <span class="slider"></span>
      </label>
      <span>Automation ON</span>
    </div>
  </div>

  <div class="ad-card" id="div3">
    <div class="heading">Ad Section 3</div>
    <button class="btn" data-ad="https://otieu.com/4/10101867" data-final="https://example.com/final3">AD is Loading</button>
    <div class="ad-info">
      <p>Ads Loaded: <span class="adsLoaded">0</span></p>
      <p>Button Clicked: <span class="btnClicked">0</span></p>
    </div>
    <div class="card-switch">
      <label class="switch">
        <input type="checkbox" class="cardSwitch">
        <span class="slider"></span>
      </label>
      <span>Automation ON</span>
    </div>
  </div>
</div>

<script>
  const powerSwitch = document.getElementById('powerSwitch');
  const cards = document.querySelectorAll('.ad-card');
  powerSwitch.checked = false;
  const sleep = ms => new Promise(r => setTimeout(r, ms));

  function setupCard(card) {
    const btn = card.querySelector('.btn');
    const adsLoadedSpan = card.querySelector('.adsLoaded');
    const btnClickedSpan = card.querySelector('.btnClicked');
    const adLink = btn.dataset.ad;
    const finalLink = btn.dataset.final;
    const cardSwitch = card.querySelector('.cardSwitch');
    let adsLoaded = 0, btnClicked = 0;

    async function loadAd() {
      if (!powerSwitch.checked || !cardSwitch.checked) return;
      btn.style.display = 'block';
      btn.disabled = true;
      btn.textContent = 'AD is Loading...';
      await sleep(3000);
      if (!powerSwitch.checked || !cardSwitch.checked) return;
      adsLoaded++;
      adsLoadedSpan.textContent = adsLoaded;
      btn.disabled = false;
      btn.textContent = 'Click to Open Ad';
    }

    async function clickAd() {
      if (btn.disabled) return;
      btnClicked++;
      btnClickedSpan.textContent = btnClicked;
      btn.disabled = true;
      btn.textContent = 'Opening Ad...';
      window.open(adLink, '_blank');
      await sleep(5000);
      btn.textContent = 'Redirecting...';
      await sleep(1000);
      // Redirect or stay on page
      window.location.href = finalLink;
    }

    async function runCycle() {
      while (powerSwitch.checked && cardSwitch.checked) {
        await loadAd();
        if (powerSwitch.checked && cardSwitch.checked) await clickAd();
        await sleep(4000); // wait before next loop
      }
    }

    cardSwitch.addEventListener('change', () => { if (cardSwitch.checked) runCycle(); });
    return { runCycle };
  }

  const controllers = Array.from(cards).map(setupCard);

  async function loopAllCards() {
    while (powerSwitch.checked) {
      for (let c of controllers) {
        await c.runCycle();
        await sleep(2000);
      }
    }
  }

  powerSwitch.addEventListener('change', async () => {
    if (powerSwitch.checked) {
      cards.forEach(card => card.querySelector('.cardSwitch').checked = true);
      loopAllCards();
    } else {
      cards.forEach(card => {
        card.querySelector('.cardSwitch').checked = false;
      });
    }
  });
</script>

</body>
</html>